#для запуска на сервере с nginx
# приложение по докер файлу
#version: "3.8"

services:


  app_1:
    build:
      #       . - текущая папка с docker файлом
      context: .
      #      сборка образа приложения по docker файлом
      dockerfile: Dockerfile_1
    networks:
      - smartFront

    container_name: front
    ports:
      #      внешний порт любой(80 или 443 что бы не вводить при зпросе)
      #      внутренний порт такой же как в апликешин - связь контейнера с приложением

      - "9001:8098"

      #      порт для удаленного дебага 5005 по умолчанию
      - "5004:5004"

    #        Переопределение переменных из property (задание путей для сохранения картинок внутри контейнера - простые строки)
    environment:
      feign.url: http://45.131.42.43:9002



  nginx:
    image: nginx:1.27.5
    container_name: nginx_front
    ports:
      - "80:80"  # Доступен на порту 80
      - "443:443"
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf  # Подключение конфигурационного файла  /etc/nginx/conf.d/
#      - /etc/letsencrypt/live/smart18.ru/:/etc/ssl/  # Папка с сертификатами /etc/ssl/ - существующаяя папка на сервере Unix
      - /etc/letsencrypt/archive/smart18.ru/:/etc/letsencrypt/archive/smart18.ru/

    depends_on:
      - app_1
    networks:
      - smartFront


networks:
  smartFront:
    driver: bridge




